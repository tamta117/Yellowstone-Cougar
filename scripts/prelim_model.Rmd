---
title: "prelim_model"
author: "Tam Ta"
date: "4/19/2022"
output: html_document
---

```{r load library, include=FALSE}
library(here)
library(tidyverse)
library(ggplot2)
```

```{r load data, include=FALSE}
dir_all<-read.csv(here("data/all_elev.csv"))
  #subset(species=="elk"|species=="mule deer")
```

```{r plot}
ggplot(dir_all)+
         #filter(species=="elk"|species=="mule deer"))+
  geom_boxplot(aes(x=species,y=elevation))+
  theme(axis.text.x=element_text(angle=45, hjust=1))
ggplot(dir_all)+
  geom_boxplot(aes(x=season,y=elevation))
ggplot(dir_all%>%
         filter(species=="elk"|species=="mule deer"))+
  geom_point(aes(x=jday,y=elevation,color=species))
ggplot(dir_all%>%
         filter(species=="elk"|species=="mule deer")%>%
         filter(age!="unk"))+
  geom_boxplot(aes(x=age,y=elevation))
ggplot(dir_all%>%
         filter(species=="elk"|species=="mule deer")%>%
         filter(age!="unk"))+
  geom_point(aes(x=jday,y=elevation,color=age))
```
Looks like it's not a linear relationship but exponential. Therefore, we will perform a generalized linear model.

```{r change data to binary}
dir_mod<-dir_all%>%
  subset(dir_all$age!="unk")%>%
  subset(dir_all$season=="winter")%>%
  mutate(MUDE=ifelse(species=="mule deer",1,0))%>%
  mutate(ELK=ifelse(species=="elk",1,0))%>%
  mutate(age.n=case_when(
    age=="young"~1,
    age=="yearling"~2,
    age=="adult"~3,
    age=="old adult"~4
  ))
  # mutate(PRHO=ifelse(species=="pronghorn",1,0))%>%
  # mutate(MAMO=ifelse(species=="marmot",1,0))%>%
  # mutate(BISH=ifelse(species=="bh sheep",1,0))
```
The models that we will run once we have complete dataset from GIS team:
name<-glm(ELK~elevation, distance to water, distance to roads, canopy cover)

name<-glm(MUDE~elevation, distance to water, distance to roads, canopy cover)

name<-glm(age.n~elevation, distance to water, distance to roads, canopy cover)

```{r model for elk}
m.elk<-glm(ELK~elevation+age+jday+jday^2,data=dir_mod,family=binomial)
summary(m.elk)
```
Elevation does not have a significant effect on the probability of getting an elk.
Compared to adult, old adult, yearling, and young elk has a significantly higher probability of being killed.

```{r model for mule deer}
m.mude<-lm(elevation~season,data=dir_mod)
summary(m.mude)
```

```{r model for mule deer}
ele.prho<-glm(PRHO~elevation,data=dir_mod,family="binomial")
summary(ele.prho)
```

```{r model for mule deer}
ele.mamo<-glm(MAMO~elevation,data=dir_mod,family="binomial")
summary(ele.mamo)
```

```{r model for mule deer}
ele.bish<-glm(BISH~elevation,data=dir_mod,family="binomial")
summary(ele.bish)
```

