---
title: "final_model"
author: "Tam Ta"
date: "5/3/2022"
output: html_document
---
#### To do list
-wait for data
-work on brochures and presentations
-figure out how to make the graphs
-run the models


#### Setup
```{r load library, include=FALSE}
library(here)
library(tidyverse)
library(dplyr)
library(raster) #for scaling
```

```{r load data, include=FALSE}
kill<-read.csv(here("data/.csv"))%>%
  mutate(kill=1)
random<-read.csv(here("data/.csv"))%>%
  mutate(kill=0)
```

#### Prepare datasets for model

```{r join kills and random points}
premod<-bind_rows(random,kill)%>%
  select(kill,species,elevation,canopy_cover,slope)
```

Scale any numerical columns, except lat/long and use/nonuse. This would involve elevation, slope, and canopy cover. Scaling would help standardize the numerical covariates --> allows us to compare coefficients to each other.

```{r scale}
premod.scale <- scale(premod[3:5])

#add back any columns that we did not scale
mod <- data.frame("kill" = premod$kill, "species" = premod$species,
                  premod.scale)
```

```{r filter data, include=FALSE}
elk<-mod%>%
  filter(species=="elk" | kill = 0)
mule<-mod%>%
  filter(species=="mule deer" | kill = 0)
```

#### Models & AIC

Null model to compare to logistic regressions. If AIC of logistics are above or <2 below null model, then the relationships are not significant. 
```{r null model}
m.null <- glm(kill ~ 1, family = binomial, data=mod)
summary(m.null)
```

```{r elk model}
m.elk<-glm(kill~elevation+canopy_cover+slope, data=elk,
          family=binomial)
summary(m.elk)
```

```{r mule deer model}
m.mule<-glm(kill~elevation+canopy_cover+slope, data=mule,
          family=binomial)
summary(m.elk)
```

Lower AIC = better. Choose model with the lowest AIC. Make sure it is >2 below the null.

```{r aic table}
library(AICcmodavg)

#the models you're comparing
model.set <- list(m.null, m.elk, m.mule)
model.names <- c("null", "elk", "mule deer")

#makes the table
aic = aictab(model.set, modnames = model.names)
aic
```